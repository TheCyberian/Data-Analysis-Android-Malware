install.packages("wordcloud") 
library("wordcloud")
library('dplyr')
library(data.table)

# Splitting data frame into two - malicious and benign for wordcloud function
malicious_data_frame = subset(cleaned_data, cleaned_data$type=='malicious')
benign_data_frame = subset(cleaned_data, cleaned_data$type=='benign')

wordcloud(words = malicious_data_frame$variable,  
          freq = malicious_data_frame$value, 
          min.freq = 1,  
          max.words = 200, 
          random.order = FALSE,  
          rot.per = 0.35,  
          colors = brewer.pal(8, "Dark2"))

wordcloud(words = benign_data_frame$variable,  
          freq = benign_data_frame$value, 
          min.freq = 1,  
          max.words = 200, 
          random.order = FALSE,  
          rot.per = 0.35,  
          colors = brewer.pal(8, "Dark2"))


malicious_data_frame_net = subset(cleaned_data_net_traffic, 
                                  cleaned_data_net_traffic$type=='malicious', 
                                  select=-c(type))

benign_data_frame_net = subset(cleaned_data_net_traffic, 
                               cleaned_data_net_traffic$type=='benign',
                               select=-c(type))

unique(malicious_data_frame_net[c('name')])
unique(benign_data_frame_net[c('name')])
###################################################
#df <- colSums(benign_data_frame_net, na.rm = FALSE)
#aggregate(name ~ malicious_data_frame_net, df, sum)

#df <- data.table(malicious_data_frame_net,by=name)
#dat <- malicious_data_frame_net[unique(malicious_data_frame_net$name), , by=name]

#dat <- rowsum(malicious_data_frame_net, group=unique(malicious_data_frame_net$name))
#table(malicious_data_frame_net)
#solution<-as.data.frame(table(unlist(malicious_data_frame_net)))
#dat <- sapply(malicious_data_frame_net,  )
################
wordcloud(words = malicious_data_frame_net$name,  
          freq = malicious_data_frame_net$volume_bytes, 
          min.freq = 1,  
          max.words = 200, 
          random.order = FALSE,  
          rot.per = 0.35,  
          colors = brewer.pal(8, "Dark2"))
