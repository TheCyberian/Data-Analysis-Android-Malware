---
title: "data_visualization_permissions.R"
author: "Utkarsh Raghav"
---
#### Handling Required Packages
if(!require("wordcloud")) install.packages("wordcloud") 

library(dplyr)
library(data.table)
library(ggplot2)
library(viridis)
library(hrbrthemes)

# Filtering out top 30 permissions from the sorted permissions data
g <- sorted_data[1:30,] %>% ggplot(aes(fill=type, x=value, y=variable))
# Plotting the bar plot for the permissions data, 
# also setting the labels and theme functions for better visualization
g + geom_bar(position="stack", stat="identity") +
  scale_fill_viridis(discrete = T) +
  ggtitle("Studying Android Malware Permissions") +
  facet_wrap(~type) +
  theme_bw() +
  theme(axis.text.x = element_text(size=7.5, angle=90, hjust=1.0, vjust=0.2)) +
  xlab("\nNumber of Applications") +
  ylab("Permission Names")


# Splitting data frame into two - malicious and benign for the wordcloud() function
malicious_data_frame = subset(cleaned_data, cleaned_data$type=='malicious')
benign_data_frame = subset(cleaned_data, cleaned_data$type=='benign')

# Generating the word cloud for permissions, based on their frequency in the data set
# For malicious applications
wordcloud(words = malicious_data_frame$variable,  
          freq = malicious_data_frame$value, 
          min.freq = 1,  
          max.words = 200, 
          random.order = FALSE,  
          rot.per = 0.35,  
          colors = brewer.pal(8, "Dark2"))

# For benign applications
wordcloud(words = benign_data_frame$variable,  
          freq = benign_data_frame$value, 
          min.freq = 1,  
          max.words = 200, 
          random.order = FALSE,  
          rot.per = 0.35,  
          colors = brewer.pal(8, "Dark2"))


