---
title: "data_visualization_net_traffic.R"
author: "Utkarsh Raghav"
---
  install.packages("ggplot2") 
library(ggplot2)
install.packages("viridisLite")
install.packages("viridis")
library(viridisLite)
library(viridis)
library(hrbrthemes)
install.packages("ggplot2") 
library(ggplot2)
library(ggrepel)


head(df_android_net_traffic)
colnames(df_android_net_traffic)
view(df_android_net_traffic)

plyr::count(df_android_net_traffic, vars='type')

unique(df_android_net_traffic[c('name')])

## Network Traffic volume (The skewness happens due to higher number of benign apps in the sample; packaging techniques)
cleaned_data_net_traffic$volume_mega_bytes <- cleaned_data_net_traffic$volume_bytes / 1000000

g <- cleaned_data_net_traffic %>% ggplot(aes(fill=type, x=type, y=volume_mega_bytes))

g + geom_bar(position="stack", stat="identity") +
  ggtitle("Studying Android Network Traffic Volume") +
  theme_bw() +
  theme(axis.text.x = element_text(size=15, angle=90, hjust = 0.95)) +
  xlab("Traffic Type") +
  ylab("Traffic Size (in megabytes)")


## Network Traffic DNS Query times
g <- cleaned_data_net_traffic %>% ggplot(aes(fill=type, x= type, y=dns_query_times))

g + geom_bar(position="stack", stat="identity") +
  scale_fill_manual(values = c("firebrick4", "mediumpurple4")) +
  ggtitle("Studying Android Network Traffic DNS Queries") +
  theme_bw() +
  theme(axis.text.x = element_text(size=15, angle=90, hjust = 0.95)) +
  xlab("Query Type") +
  ylab("Number of DNS Queries")


## Network Traffic source app packets
cleaned_data_net_traffic$source_app_packets_by_1000 <- cleaned_data_net_traffic$volume_bytes / 1000


g <- cleaned_data_net_traffic %>% ggplot(aes(fill=type, x=type, y=source_app_packets_by_1000))

g + geom_bar(position="stack", stat="identity") +
  scale_fill_manual(values = c("violetred3", "seagreen3")) +
  ggtitle("Studying Android Network Traffic Source App Packets") +
  theme_bw() +
  theme(axis.text.x = element_text(size=15, angle=90, hjust = 0.95)) +
  xlab("Packet Type") +
  ylab("Source App Packets Number (X 1000)")



## Scatter plot

# specify data and specify variable to use
a <- ggplot(df_android_net_traffic, aes(x=dns_query_times, y=udp_packets))
# specify the type of plot and edit the plot
a + geom_point() +
  labs(title = "Studying Android Network Traffic Source App Packets", x = "Times of DNS Query", y = "
       UDP packets number")

# change the point size and shape
a + geom_point(size=2, shape=23) +
  labs(title = "Studying Android Network Traffic Source App Packets", x = "Times of DNS Query", y = "
       UDP packets number)")  

# remove the background
a + geom_point() +
  labs(title = "Studying Android Network Traffic Source App Packets", x = "Times of DNS Query", y = "
       UDP packets number") +
  theme_bw() 

# remove the grids
a + geom_point() + 
labs(title = "Studying Android Network Traffic Source App Packets", x = "Times of DNS Query", y = "
     UDP packets number")
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) 


############## boxplots


# specify data and specify variable to use
b <- ggplot(df_android_net_traffic, aes(x= type, y= external_ips))
# specify the type of plot and edit the plot
b + geom_boxplot() +
  labs(title = "Studying Android Network Traffic Source App Packets", x = "Packet Type", y = "External IP address")

## colour
b + geom_boxplot(
  # custom boxes
  color="blue", fill="blue", alpha=0.8,
  # Notch?
  notch=TRUE, notchwidth = 0.6,
  # custom outliers
  outlier.colour="red", outlier.fill="red", outlier.size=3
) 

 ### Histogram not properly done


### Histogram
# specify data and specify variable to use
d <- ggplot(df_android_permissions, aes(type)) + stat_bin(bins = 50)
# specify the type of plot and edit the plot
d + geom_histogram() +  
labs(title = "Studying Android Network Traffic Source App Packets", x = "Packet
Type", y = "TCP packets number)")

# control bin size
d + geom_histogram(binwidth = 0.3) +
  labs(title = "Studying Android Network Traffic Source App Packets", x = "Packet
Type", y = "TCP packets number)") 

# Build a dataset with two different distributions
set.seed(1001)
data <- data.frame(
  type = c( rep("benign", 1000), rep("malicious", 1000) ),
  value = c( rnorm(1000), rnorm(1000, mean=4) ) )
# specify data and specify variable to use
g <- ggplot(data, aes(value, fill=type))
# specify the type of plot and edit the plot
g + geom_histogram(alpha=0.6, binwidth = 0.1, position="identity") +
  scale_fill_manual(values=c("green","orange")) + 
  labs(title = "Studying Android Network Traffic Source App Packets", x = "Packet Type", y = "TCP packets number)") 

## Time series plots
## some error occur in this code
# create time series data
ggplot(data  = df_android_net_traffic)
set.seed(40)
xValue <- 1:100
yValue <- cumsum(rnorm(100))
data  <- data.frame("source_app_packets","remote_app_packets")
# specify data and specify variable to use
g <- ggplot(data, aes(x=source_app_packets, y=remote_app_packets))
# specify the type of plot and edit the plot
g + geom_line() +
  labs(title = "Studying Android Network Traffic Source App Packets", x = "Packet
Type", y = "TCP packets number)")

# specify data and specify variable to use
g <- ggplot(df_android_net_traffic, aes(x= source_app_packets, y=remote_app_packets))
# specify the type of plot and edit the plot
g + geom_line(color="blue", linetype="dotdash", size=0.5) +
  labs(title = "Studying Android Network Traffic Source App Packets", x = "number of source application Packet", y = "Number of Remote application packets)") 
