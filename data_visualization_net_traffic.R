---
title: "data_visualization_net_traffic.R"
author: "Utkarsh Raghav"
---
  
library(ggplot2)
library(viridis)
library(hrbrthemes)
library(ggrepel)


head(df_android_net_traffic)
colnames(df_android_net_traffic)
view(df_android_net_traffic)

plyr::count(df_android_net_traffic, vars='type')

unique(df_android_net_traffic[c('name')])

## Network Traffic volume (The skewness happens due to higher number of benign apps in the sample; packaging techniques)
cleaned_data_net_traffic$volume_mega_bytes <- cleaned_data_net_traffic$volume_bytes / 1000000

g <- cleaned_data_net_traffic %>% ggplot(aes(fill=type, x=type, y=volume_mega_bytes))

g + geom_bar(position="stack", stat="identity") +
  ggtitle("Studying Android Network Traffic Volume") +
  theme_bw() +
  theme(axis.text.x = element_text(size=15, angle=90, hjust = 0.95)) +
  xlab("Traffic Type") +
  ylab("Traffic Size (in megabytes)")


## Network Traffic DNS Query times
g <- cleaned_data_net_traffic %>% ggplot(aes(fill=type, x=type, y=dns_query_times))

g + geom_bar(position="stack", stat="identity") +
  ggtitle("Studying Android Network Traffic DNS Queries") +
  theme_bw() +
  theme(axis.text.x = element_text(size=15, angle=90, hjust = 0.95)) +
  xlab("Query Type") +
  ylab("Number of DNS Queries")


## Network Traffic source app packets
cleaned_data_net_traffic$source_app_packets_by_1000 <- cleaned_data_net_traffic$source_app_packets / 1000
cleaned_data_net_traffic$source_app_kilobytes <- cleaned_data_net_traffic$source_app_bytes / 1000
cleaned_data_net_traffic$remote_app_kilobytes <- cleaned_data_net_traffic$remote_app_bytes / 1000


g <- cleaned_data_net_traffic %>% ggplot(aes(fill=type, x=type, y=source_app_packets_by_1000))

g + geom_bar(position="stack", stat="identity") +
  ggtitle("Studying Android Network Traffic Source App Packets") +
  theme_bw() +
  theme(axis.text.x = element_text(size=15, angle=90, hjust = 0.95)) +
  xlab("Packet Type") +
  ylab("Source App Packets Number (X 1000)")



### Pie chart [not working yet]
blank_theme <- theme_minimal()+
  theme(
    axis.title.x = element_blank(),
    axis.title.y = element_blank(),
    panel.border = element_blank(),
    panel.grid=element_blank(),
    axis.ticks = element_blank(),
    plot.title=element_text(size=14, face="bold")
  )

pie <- cleaned_data_net_traffic %>% ggplot(aes(fill=type, x="", y=source_app_packets_by_1000))

pie + geom_bar(stat="identity") +
  coord_polar("y", start=0) +
  ggtitle("Studying Android Network Traffic Source App Packets") +
  #theme_minimal() + 
  blank_theme +
  theme(axis.text.x=element_blank()) +
  #geom_text(label=scales::percent(cleaned_data_net_traffic$type), size=5, hjust = 0.5)+
  xlab("") +
  ylab("Source App Packets Percentage")


pie

