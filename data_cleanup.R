#### Handling Packages
if(!require("pacman")) install.packages("pacman")
if(!require("hrbrthemes")) install.packages("hrbrthemes")
if(!require("viridis")) install.packages("viridis")

pacman::p_load(pacman, party, rio, tidyverse, reshape2)

# Loading & Exploration csv data with Dataframes 
df_android_net_traffic <- read_delim("archive/android_traffic.csv", delim=';')
df_android_permissions <- read_delim("archive/train.csv", delim=';')

### Exploring the data sets
head(df_android_net_traffic)
head(df_android_permissions)

summary(df_android_net_traffic)
summary(df_android_permissions)

### Shape/Dimensions of data set
dim(df_android_net_traffic)
dim(df_android_permissions)

sum(df_android_permissions)
sum(df_android_net_traffic)

colnames(df_android_permissions)
colnames(df_android_net_traffic)


# Data transformations and cleaning
df_man <- rowsum(x=df_android_permissions, group=df_android_permissions$type)

library(reshape2)
molten_data = melt(df_man, id.vars = c("type"), level=1)
molten_data

# typeof(molted)
# Updating Labels
molten_data$type[which(molten_data$type == 199)] <- "malicious"
molten_data$type[which(molten_data$type == 0)] <- "benign"

### Removing unnecessary data entries
cleaned_data = subset(
  molten_data, variable!='android' & 
    variable != 'test_permission' & 
    value != 0)
view(cleaned_data)

### Sorted data
sorted_data <- cleaned_data[order(-cleaned_data$value),]
